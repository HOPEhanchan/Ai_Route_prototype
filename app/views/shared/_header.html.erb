<nav class="bg-white border-b border-gray-200">
  <div class="max-w-4xl mx-auto px-4 py-3 flex items-center justify-between gap-3">

    <!-- Â∑¶Ôºö„É≠„Ç¥ -->
    <div class="min-w-0">
      <%= link_to (user_signed_in? ? lists_path : root_path),
                  class: "inline-flex flex-col sm:flex-row sm:items-baseline gap-0.5 sm:gap-2 no-underline" do %>

        <span class="text-lg sm:text-xl font-bold text-emerald-500 whitespace-nowrap leading-tight">
          <%= t("header.title") %>
        </span>

        <span class="hidden sm:block text-[11px] text-gray-500 sm:mt-0.5 leading-snug truncate">
          <%= t("header.tagline") %>
        </span>
      <% end %>
    </div>

    <!-- Âè≥Ôºö„Éä„Éì -->
    <% if user_signed_in? %>
      <div class="flex items-center gap-2">

        <!-- PCÔºölist„Å®spot„ÅØ„ÅÇ„Åà„Å¶„Éò„ÉÉ„ÉÄ„Éº„Å´Âá∫„Åô -->
        <div class="hidden sm:flex items-center gap-1">
          <%= link_to lists_path,
                class: "px-3 py-1.5 rounded-md text-sm text-emerald-700 hover:bg-emerald-50 whitespace-nowrap" do %>
            [ üìù„É™„Çπ„Éà‰∏ÄË¶ß ]
          <% end %>

          <%= link_to spots_path,
                class: "px-3 py-1.5 rounded-md text-sm text-emerald-700 hover:bg-emerald-50 whitespace-nowrap" do %>
            [ üìç„Çπ„Éù„ÉÉ„Éà‰∏ÄË¶ß ]
          <% end %>
        </div>

        <!-- Âè≥‰∏ä„É°„Éã„É•„ÉºÔºàPC/„Çπ„Éû„ÉõÂÖ±ÈÄö„ÅÆË¶ã„ÅüÁõÆÔºâ -->
        <details class="relative">
          <summary class="list-none cursor-pointer flex items-center gap-2 select-none">
            <% if current_user.avatar_url.present? %>
              <img src="<%= current_user.avatar_url %>"
                   alt="avatar"
                   class="w-8 h-8 rounded-full object-cover border border-slate-300" />
            <% else %>
              <div class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-white text-sm">
                <%= current_user.email.first.upcase %>
              </div>
            <% end %>

            <span class="text-[11px] text-slate-500 hidden sm:inline">
              „É°„Éã„É•„Éº
            </span>
            <span class="text-[10px] text-slate-400 hidden sm:inline">
              ‚ñº
            </span>
          </summary>

          <div class="absolute right-0 mt-2 w-44 bg-white/95 backdrop-blur
                      rounded-xl shadow-lg border border-emerald-100 py-2 z-30">

            <p class="px-3 pb-2 text-[11px] text-slate-400 truncate">
              <%= current_user.email %>
            </p>

            <!-- Admin -->
            <% if current_user.admin? %>
              <%= link_to admin_contact_messages_path,
                    class: "block px-3 py-2 text-sm hover:bg-amber-50 text-amber-700 font-semibold" do %>
                üõ† Admin
              <% end %>
              <div class="my-1 border-t border-slate-100"></div>
            <% end %>

            <!-- „Çπ„Éû„ÉõÔºölist„Å®„Çπ„Éù„ÉÉ„Éà„ÇÇ„É°„Éã„É•„Éº„Å´Âê´„ÇÅ„Çã -->
            <div class="sm:hidden">
              <%= link_to lists_path, class: "block px-3 py-2 text-sm hover:bg-slate-50" do %>
                üìù „É™„Çπ„Éà
              <% end %>
              <%= link_to spots_path, class: "block px-3 py-2 text-sm hover:bg-slate-50" do %>
                üìç „Çπ„Éù„ÉÉ„Éà
              <% end %>
              <div class="my-1 border-t border-slate-100"></div>
            </div>

            <%= link_to profile_path, class: "block px-3 py-2 text-sm hover:bg-slate-50" do %>
              üë§ „Éó„É≠„Éï„Ç£„Éº„É´
            <% end %>

            <%= link_to "AiRoute„Å®„ÅØÔºü", about_path, class: "block px-3 py-2 text-sm hover:bg-slate-50" %>
            <%= link_to "Âà©Áî®Ë¶èÁ¥Ñ", terms_path, class: "block px-3 py-2 text-sm hover:bg-slate-50" %>
            <%= link_to "„Éó„É©„Ç§„Éê„Ç∑„Éº„Éù„É™„Ç∑„Éº", privacy_path, class: "block px-3 py-2 text-sm hover:bg-slate-50" %>
            <%= link_to "„ÅäÂïè„ÅÑÂêà„Çè„Åõ", new_contact_messages_path, class: "block px-3 py-2 text-sm hover:bg-slate-50" %>

            <div class="mt-2 pt-2 border-t border-slate-100">
              <%= button_to "„É≠„Ç∞„Ç¢„Ç¶„Éà",
                    destroy_user_session_path,
                    method: :delete,
                    data: { turbo_confirm: t("header.nav.logout_confirm") },
                    class: "w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50" %>
            </div>
          </div>
        </details>
      </div>

    <% else %>
      <!-- Êú™„É≠„Ç∞„Ç§„É≥ -->
      <div class="flex items-center gap-3 text-xs sm:text-sm whitespace-nowrap">
        <%= link_to t("header.nav.login"),
              new_user_session_path,
              class: "text-gray-700 hover:text-emerald-600" %>

        <%= link_to t("header.nav.signup"),
              new_user_registration_path,
              class: "px-3 py-1.5 rounded-md bg-emerald-500 text-white hover:bg-emerald-600" %>
      </div>
    <% end %>

  </div>
</nav>
