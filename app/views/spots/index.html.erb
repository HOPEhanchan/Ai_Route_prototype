<div class="min-h-[60vh] bg-slate-50">
  <div class="max-w-3xl mx-auto px-4 py-8 space-y-4">

    <!-- タイトル行 -->
    <div class="flex justify-between items-center gap-3">
      <div>
        <h1 class="text-xl font-bold text-emerald-600">
          あなたの行きたいスポット
        </h1>
        <p class="mt-1 text-xs sm:text-sm text-gray-600">
          気になったお店やスポットをストックして、<br>
          あとで行き先リストにまとめていけるようにします。
        </p>
      </div>

      <div class="shrink-0">
        <%= link_to "+ 追加",
                    new_spot_path,
                    class: "inline-flex items-center px-3 py-2 rounded-lg text-xs sm:text-sm
                            bg-emerald-500 text-white font-medium hover:bg-emerald-600" %>
      </div>
    </div>

    <!-- 🔽 リストで絞り込みドロップダウン -->
    <div class="flex items-center justify-between gap-3 mt-2 text-xs sm:text-sm">
      <%= form_with url: spots_path, method: :get, local: true, class: "flex items-center gap-2" do |f| %>
        <%= f.select :list_id,
              options_for_select(
                [["すべて", ""]] + @lists.map { |list| [list.name, list.id] },
                (@current_list&.id&.to_s || "")
              ),
              {},
              class: "rounded-full border border-slate-300 bg-white px-3 py-1.5
                      text-xs sm:text-sm min-w-[140px]",
              onchange: "this.form.submit()" %>
      <% end %>
    </div>

    <!-- 🔽 スポットカード一覧 -->
    <% if @spots.any? %>
      <div class="space-y-3">
        <% @spots.each do |spot| %>
          <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4">
            <!-- 上段：タイトル＋URL -->
            <div class="flex justify-between items-start gap-3">
              <div class="space-y-1">
                <h2 class="font-semibold text-gray-800 text-sm sm:text-base">
                  <span class="block max-w-[220px] truncate sm:max-w-none sm:whitespace-normal">
                    <%= spot.title.presence || "（タイトル未入力）" %>
                  </span>
                </h2>

                <% if spot.url.present? %>
                  <a href="<%= spot.url %>"
                     target="_blank" rel="noopener"
                     class="inline-flex items-center text-xs text-emerald-600 hover:text-emerald-700 break-all">
                    <span class="truncate max-w-[220px] sm:max-w-xs">
                      <%= spot.url %>
                    </span>
                  </a>
                <% end %>
              </div>
            </div>

            <% if spot.image_url.present? %>
              <div class="mt-3">
                <%= image_tag spot.image_url,
                      class: "w-full max-h-48 object-cover rounded-lg border border-slate-200" %>
              </div>
            <% end %>

            <!-- 中段：ひとことメモ -->
            <div class="mt-3 pt-3 border-t border-slate-100 space-y-1">
              <p class="text-xs font-medium text-slate-500">
                ひとことメモ
              </p>
              <p class="text-sm text-slate-700 whitespace-pre-line">
                <%= spot.memo.presence || "まだメモがありません。" %>
              </p>
            </div>

            <!-- 下段：フッター -->
            <div class="mt-3 flex justify-between items-center text-[11px] sm:text-xs">
              <div class="text-gray-400 whitespace-nowrap">
                作成日: <%= l spot.created_at.to_date %>
              </div>

              <div class="flex gap-3">
                <%= link_to "詳細を見る",
                            spot_path(spot),
                            class: "text-gray-600 hover:text-gray-800" %>

                <%= link_to "編集",
                            edit_spot_path(spot),
                            class: "text-emerald-600 hover:text-emerald-700" %>

                <%= button_to "削除",
                              spot_path(spot),
                              method: :delete,
                              data: { turbo_confirm: "このスポットを削除しますか？" },
                              class: "text-red-500 hover:text-red-600" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="mt-6 rounded-xl border border-dashed border-slate-300 bg-white p-5 text-center">
        <p class="text-sm text-gray-600">
          「行きたいスポット」が登録されていません。
        </p>
        <p class="mt-1 text-xs text-gray-500">
          気になるお店やスポットのURLを見つけたら、<br>
          右上の <span class="font-semibold">「＋ 追加」</span> から登録しておきましょう。
        </p>
      </div>
    <% end %>
  </div>
</div>
