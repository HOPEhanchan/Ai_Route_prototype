<div class="min-h-[60vh] bg-slate-50">
  <div class="max-w-3xl mx-auto px-4 py-8 space-y-4">

    <!-- タイトル行：スマホ＝縦並び / PC＝横並び -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
      <div class="min-w-0">
        <p class="text-xs text-gray-500 mb-1">行き先リスト</p>
        <h1 class="text-xl font-bold text-emerald-600 break-words">
          <span class="block max-w-[220px] truncate sm:max-w-none sm:whitespace-normal">
            <%= @list.name %>
          </span>
        </h1>
      </div>

      <!-- ボタンたち：スマホでは下に縦並び -->
      <div class="flex flex-wrap gap-2 sm:justify-end">
        <%= link_to "リスト名変更",
                    edit_list_path(@list),
                    class: "px-3 py-1 rounded-lg bg-emerald-50 text-emerald-600
                            border border-emerald-200 hover:bg-emerald-100
                            text-xs sm:text-sm" %>

        <%= link_to "一覧に戻る",
                    lists_path,
                    class: "px-3 py-1 rounded-lg border border-slate-300 bg-white
                            text-slate-700 hover:bg-slate-100 hover:text-slate-900
                            text-xs sm:text-sm transition" %>
      </div>
    </div>

    <% if @list.spots.any? %>
      <div class="space-y-3">
        <% @list.spots.each do |spot| %>
          <% list_item = @list.list_items.find { |li| li.spot_id == spot.id } %>

          <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4">
            <div class="space-y-2">
              <!-- 上：スポット情報（タイトル & URL） -->
            <div>
                <h2 class="font-semibold text-gray-800 text-sm sm:text-base">
                  <span class="block max-w-[220px] truncate sm:max-w-none sm:whitespace-normal">
                    <%= truncate(spot.title.presence || "（タイトル未入力）", length: 20) %>
                  </span>
                </h2>

                <% if spot.url.present? %>
                  <a href="<%= spot.url %>"
                     target="_blank" rel="noopener"
                     class="inline-flex items-center text-xs text-emerald-600 hover:text-emerald-700 break-all mt-1">
                    <%= spot.url %>
                  </a>
                <% end %>
              </div>

              <!-- 下：サムネ + ボタン（詳細 / 外す） -->
              <div class="mt-2 flex items-center justify-between gap-3">
                <!-- 左：ちっちゃいサムネ（正方形） -->
                <% if spot.image_url.present? %>
                  <div class="w-16 h-16 sm:w-20 sm:h-20 flex-shrink-0">
                    <%= image_tag spot.image_url,
                          class: "w-full h-full object-cover rounded-lg border border-slate-200" %>
                  </div>
                <% end %>

                <!-- 右：ボタン縦並び -->
                <div class="flex flex-col items-end gap-1 text-[11px] sm:text-xs flex-shrink-0">
                  <!-- 詳細 -->
                  <%= link_to spot_path(spot),
                              class: "inline-flex items-center gap-1 px-3 py-1 rounded-lg
                                      border border-slate-200 bg-white text-gray-700
                                      hover:bg-slate-50 hover:border-emerald-200 hover:text-emerald-700
                                      transition" do %>
                    <span>詳細</span>
                  <% end %>

                  <!-- 外す -->
                  <% if list_item %>
                    <%= button_to list_list_item_path(@list, list_item),
                                  method: :delete,
                                  data: { turbo_confirm: "このリストから外しますか？" },
                                  class: "inline-flex items-center gap-1 px-3 py-1 rounded-lg
                                          border border-red-200 bg-red-50 text-red-700
                                          hover:bg-red-100 transition" do %>
                      <span>外す</span>
                    <% end %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

      <% end %>
      </div>
    <% else %>
      <div class="mt-6 rounded-xl border border-dashed border-slate-300 bg-white p-5 text-center">
        <p class="text-sm text-gray-600">
          まだこのリストには<br>
          スポットが追加されていません。
        </p>
        <p class="mt-1 text-xs text-gray-500">
          「📍スポット」一覧から、<br>
          このリストに追加していきましょう。
        </p>
      </div>
    <% end %>

  </div>
</div>
